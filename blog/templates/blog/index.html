{% extends './base.html' %}
{% load staticfiles %}

{% block title %}首页{% endblock %}

{% block left_content %}

<div class="body-main">
         {% for article in page_article_list %}
          <div>
             <h2>
               <a href="/blog/detail/{{article.article_id}}">{{ article.title }}</a>
             </h2>
               <p>{{ article.brief_content |truncatewords:30 }}</p>  {# 显示 变量的前30个单词#}
             <span>点赞数 {{ article.dianzan.count }}</span>&nbsp;&nbsp;&nbsp;&nbsp;

         {% if user in article.dianzan.all %}
          <span>已点赞</span>
          {% else %}
             <span><a href="#" onclick="article_dianzan({{ article.article_id }}, 'like')">点赞</a></span>
         {% endif %}

          </div>
         {% endfor %}
</div>

<!-- 分页 -->
       <div class="col-md-4 col-md-offset-3">
        <nav aria-label="Page navigation">
          <ul class="pagination">
            <li>
      {% if page_article_list.has_previous %}
{#         返回上一页的页码   #}
         <a href="?page={{ page_article_list.previous_page_number }}">&laquo;</a>
      {% else %}
         <a href="?page={{ page_article_list.number }}">&laquo;</a>
     {% endif %}

            </li>
         {%for num in page_num %}
           <li><a href="/blog/index?page={{num}}">{{num}}</a></li>
         {%endfor %}
           <li>
  {% if page_article_list.has_next %}
{#         返回下一页的页码   #}
         <a href="?page={{ page_article_list.next_page_number }}">&raquo;</a>
      {% else %}
         <a href="?page={{ page_article_list.paginator.num_pages }}">&raquo;</a>
     {% endif %}

          </li>
        </ul>
       </nav>
    </div>


<script type="text/javascript" src='{% static "js/jquery.js" %}'></script>
<script type="text/javascript" src="{% static 'js/layer.js' %}"></script>
<script>
{# 文章点赞    ajax方式 #}
function article_dianzan(id,action){
            $.ajax({
                url:"{% url 'blog:article_dianzan' %}",
                type:'POST',
                data:{'id':id, 'action':action},
                success:function (e) {
                      if(e == "1"){
                        layer.msg('感谢点赞');
                        window.location.reload();
                    } else {
                        layer.msg('我会继续努力的...');
                        window.location.reload();
                    }
            },
        });
  }
</script>

{% endblock %}

