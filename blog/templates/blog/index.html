{% extends './base.html' %}
{% load staticfiles %}

{% block title %}懂得Talk-董衍杰博客-分享学习的心得,记录生活的瞬间{% endblock %}
{% block left_content %}

    <!--路径导航  导航条-->
    <nav class="breadcrumb">
        <div class="container"><i class="Hui-iconfont">&#xe67f;</i>
            <a href="/blog/" class="c-primary">首页</a>
        </div>
    </nav>

    {#    留作 首页 精选文章 排名#}
    {#    <div class="row">#}
    {#        <div class="col-md-6 col-sm-6">#}
    {#            <article class="blog-teaser">#}
    {#                <header>#}
    {#                     <img src="{{ MEDIA_URL }}{{ article.article_pic }}" alt="">#}
    {#                    <h3><a href="single.html">Blackor - Responsive HTML5 Theme</a></h3>#}
    {#                    <span class="meta">19 August 2015, John Doe</span>#}
    {#                    <hr>#}
    {#                </header>#}
    {#                <div class="body">#}
    {#                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatum, sit. Doloribus dolores neque#}
    {#                    eos. Velit eveniet, necessitatibus aut sit tenetur perferendis! Commodi pariatur dignissimos, quis#}
    {#                    sequi odit iusto cumque quod!#}
    {#                </div>#}
    {#                <div class="clearfix">#}
    {#                    <a href="single.html" class="btn btn-clean-one">Read more</a>#}
    {#                </div>#}
    {#            </article>#}
    {#        </div>#}
    {#    </div>#}


    <div class="row">
        {% for article in page_article_list %}
            <div class="col-md-6 col-sm-6">
                <article class=" blog-teaser">
                    <header>
                        <img src="{{ MEDIA_URL }}{{ article.article_pic }}" alt="">
                        {#                         <img src="{% static '{{ article.article_pic }}' %}" alt="">#}
                        {#                    标题     #}
                        <h3><a href="/blog/detail/{{ article.article_id }}">{{ article.title }}</a></h3>
                    <span class="meta">
                        / <span>点赞数 {{ article.dianzan.count }}&nbsp;&nbsp;&nbsp;&nbsp;</span>
                         <span> / 浏览量：{{ article.click }} &nbsp;&nbsp; </span>
                        <span>   / 评论总数：{{ article.article_comment.count }}</span>
                    </span>
                        <hr>
                    </header>

                    <div class="body">
                        {#                    摘要 ，简要内容...#}
                        {{ article.brief_content |truncatewords:30 }}
                    </div>
                    <div class="clearfix">
                        <a href="/blog/detail/{{ article.article_id }}" class="btn btn-clean-one">
                            Read More <i class="fa fa-angle-double-right" aria-hidden="true"></i> </a>
                    </div>
                </article>
            </div>
        {% endfor %}
    </div>

    <div class="paging">
        <a href="#" class="older"></a>
    </div>



    <!-- 分页 Blog Pagination -->
    <div class="blog-pagination">
        <ul class="pagination">
            <li class="page-item">
                {% if page_article_list.has_previous %}
                    <a class="page-link" href="?page={{ page_article_list.previous_page_number }}">
                        <i class="fa fa-caret-left" aria-hidden="true"></i>上一页</a>
                {% else %}
                    <a class="page-link" href="?page={{ page_article_list.number }}">
                        <i class="fa fa-caret-left" aria-hidden="true"></i></a>
                {% endif %}
            </li>
            {% for num in page_num %}
                <li class="page-item"><a href="/blog/index?page={{ num }}" class="page-link">{{ num }}</a></li>
            {% endfor %}

            <li class="page-item">
                {% if page_article_list.has_next %}
                    <a class="page-link" href="?page={{ page_article_list.next_page_number }}">
                        <i class="fa fa-caret-right" aria-hidden="true"></i>下一页</a>
                {% else %}
                    <a class="page-link" href="?page={{ page_article_list.paginator.num_pages }}">
                        <i class="fa fa-caret-right" aria-hidden="true"></i></a>
                {% endif %}
            </li>
        </ul>
    </div>



    <script type="text/javascript" src="{% static 'js/layer.js' %}"></script>
    <script>
        {#文章点赞    ajax方式#}

        function article_dianzan(id, action) {
            $.ajax({
                url: "{% url 'blog:article_dianzan' %}",
                type: "POST",
                data: {
                    'id': id,
                    'action': action,
                },
                async: false,
                success: function (e) {
                    console.log("run");

                    if (e == "1") {
                        layer.msg('感谢点赞,我会继续努力...');
                        setTimeout(function () {
                            window.location.reload();
                        }, 1000);

                    } else {
                        layer.msg('亲，登录后再来点赞哦~');
                    }
                },
            });
        }
    </script>

{% endblock %}

{% block sidebar %}
    {% include 'blog/sidebar.html' %}
{% endblock %}